<div class="animated fadeIn">
  <h3>Sales Quotation Management.</h3>
  <div class="row">
    <div class="col-9 pr-0">
      <div class="datatable-container">
        <div class="progress-bar progress-bar-striped progress-bar-animated prog-bar" [hidden]="!isLoading"></div>
        <ngx-datatable class="bootstrap"
                       [rows]="rows"
                       [columnMode]="'flex'"
                       [headerHeight]="40"
                       [summaryRow]="false"
                       [footerHeight]="40"
                       [rowHeight]="'auto'"
                       [reorderable]="false"
                       [externalPaging]="true"
                       [count]="page.totalElements"
                       [offset]="page.pageNumber"
                       [limit]="page.size"
                       [externalSorting]="true"
                       (page)="setPage($event)"
                       (sort)="onSort($event)">
          <ngx-datatable-column name="Quotation #" prop="quoteNumber" [flexGrow]="1">
            <ng-template let-value="value" ngx-datatable-cell-template>
              <div>{{ value }}</div>
            </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Date" prop="date" [flexGrow]="1">
            <ng-template let-value="value" ngx-datatable-cell-template>
              <div>{{ value }}</div>
            </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Customer" prop="customer.name" [flexGrow]="2">
            <ng-template let-salesQuotation="row" ngx-datatable-cell-template>
              <div>{{ salesQuotation.customerName }}</div>
              <div class="small">{{ salesQuotation.customerAddress }}</div>
            </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Total Amount" prop="totalAmount" [flexGrow]="2">
            <ng-template let-column="column" let-sort="sortFn" ngx-datatable-header-template>
              <span class="datatable-header-cell-wrapper float-right">
                <span class="datatable-header-cell-label draggable" (click)="sort()">{{ column.name }}</span>
              </span>
            </ng-template>
            <ng-template let-salesQuotation="row" ngx-datatable-cell-template>
              <div class="text-right">
                <div>{{ salesQuotation.totalAmount | currency:'PHP':'₱ ' }}</div>
                <div class="small text-italicize">Delivery Fee: {{ salesQuotation.deliveryFee | currency:'PHP':'₱ ' }}</div>
              </div>
            </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="" [flexGrow]="2">
            <ng-template ngx-datatable-header-template>
              <a routerLink="/sales-quotations/edit/0" class="btn btn-sm btn-primary float-right" accesskey="n"><i class="fa fa-plus"></i> New Sales Quotation</a>
            </ng-template>
            <ng-template ngx-datatable-cell-template let-row="row">
              <div class="text-right">
                <a routerLink="/sales-quotations/info/{{ row.id }}" class="btn btn-ghost-primary" title="View sales quotation information.">
                  <i class="fa fa-sticky-note-o"></i>
                </a>
                <a routerLink="/sales-quotations/edit/{{ row.id }}" class="btn btn-ghost-primary ml-1" title="Edit this sales quotation.">
                  <i class="fa fa-pencil"></i>
                </a>
                <button class="btn btn-ghost-danger ml-1" (click)="onDeleteSalesQuotation(row.id)" title="Delete this sales quotation.">
                  <i class="fa fa-trash-o"></i>
                </button>
              </div>
            </ng-template>
          </ngx-datatable-column>
        </ngx-datatable>
      </div>
    </div>
    <div class="col-3">
      <div class="card">
        <div class="card-body">
          <div class="input-group mb-2">
            <div class="input-group-prepend" title="Search by keywords.">
              <span class="input-group-text">
                <i class="fa fa-search fa-fw"></i>
              </span>
            </div>
            <input class="form-control form-control-sm" placeholder="Search by keywords." [(ngModel)]="searchTerm" />
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend" title="Search by customer.">
              <span class="input-group-text">
                <i class="cui-people fa-fw"></i>
              </span>
            </div>
            <select class="form-control form-control-sm" [(ngModel)]="selectedCustomer">
              <option [ngValue]="null">Search by customer.</option>
              <option *ngFor="let customer of customers" [ngValue]="customer">{{ customer.name }}</option>
            </select>
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend" title="Search by province.">
              <span class="input-group-text">
                <i class="fa fa-map-o fa-fw"></i>
              </span>
            </div>
            <select class="form-control form-control-sm" [(ngModel)]="selectedProvince">
              <option [ngValue]="null">Search by province.</option>
              <option *ngFor="let province of provinces" [ngValue]="province">{{ province.name }}</option>
            </select>
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend" title="Search by item.">
              <span class="input-group-text">
                <i class="fa fa-database fa-fw"></i>
              </span>
            </div>
            <select class="form-control form-control-sm" [(ngModel)]="selectedItem">
              <option [ngValue]="null">Search by item.</option>
              <option *ngFor="let item of items" [ngValue]="item">{{ item.code }} - {{ item.name }}</option>
            </select>
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend" title="Search by date range - Date from.">
              <span class="input-group-text">
                <i class="fa fa-calendar fa-fw"></i>
              </span>
            </div>
            <input type="date" class="form-control form-control-sm" placeholder="Date From" [(ngModel)]="dateFrom" />
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend" title="Search by date range - Date to.">
              <span class="input-group-text">
                <i class="fa fa-calendar fa-fw"></i>
              </span>
            </div>
            <input type="date" class="form-control form-control-sm" placeholder="Date To" [(ngModel)]="dateTo" />
          </div>
          <div>
            <button type="button" class="btn btn-sm btn-primary" (click)="search()" accesskey="s">
              <i class="fa fa-search"></i> Search
            </button>
            <button type="button" class="btn btn-sm btn-secondary ml-1" (click)="clear()" accesskey="c">
              <i class="fa fa-eraser"></i> Clear
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
